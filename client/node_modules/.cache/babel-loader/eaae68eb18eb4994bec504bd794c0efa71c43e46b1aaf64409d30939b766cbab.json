{"ast":null,"code":"var cache = require('lru-cache'),\n  through = require('through'),\n  concat = require('concat-stream');\nfunction StreamCatcher(options) {\n  this._pendingWriteStreams = {};\n  this._reading = {};\n  this._cache = cache(options);\n}\nStreamCatcher.prototype.read = function (key, readStream) {\n  var catcher = this,\n    concatStream = concat(function (data) {\n      catcher._reading[key]--;\n      if (catcher._reading[key] === 0) {\n        catcher._cache.set(key, data);\n      }\n    });\n  this._cache.del(key);\n  if (!this._reading[key]) {\n    this._reading[key] = 0;\n  }\n  this._reading[key]++;\n  readStream.pipe(concatStream);\n  var cacheThrough = through(function () {\n    var pendingWriteStreams = catcher._pendingWriteStreams[key];\n    while (pendingWriteStreams && pendingWriteStreams.length) {\n      var writeStream = pendingWriteStreams.pop();\n      if (readStream.objectMode) {\n        concatStream.getBody().forEach(function (chunk) {\n          writeStream.write(chunk);\n        });\n      } else {\n        writeStream.write(concatStream.getBody());\n      }\n      readStream.pipe(writeStream);\n    }\n  });\n  readStream.pipe(cacheThrough);\n};\nStreamCatcher.prototype.write = function (key, writeStream, needsStream) {\n  var data = this._cache.get(key);\n  if (data != null) {\n    if (Array.isArray(data)) {\n      data = '';\n    }\n    writeStream.write(data);\n    writeStream.end();\n    return;\n  }\n  if (!this._reading[key]) {\n    if (needsStream) {\n      needsStream(key);\n    }\n  }\n  if (!this._pendingWriteStreams[key]) {\n    this._pendingWriteStreams[key] = [];\n  }\n  this._pendingWriteStreams[key].push(writeStream);\n};\nStreamCatcher.prototype.has = function (key) {\n  return this._cache.has(key) || !!this._reading[key];\n};\nStreamCatcher.prototype.del = function (key) {\n  return this._cache.del(key);\n};\nStreamCatcher.prototype.reset = function (key) {\n  return this._cache.reset(key);\n};\nmodule.exports = StreamCatcher;","map":{"version":3,"names":["cache","require","through","concat","StreamCatcher","options","_pendingWriteStreams","_reading","_cache","prototype","read","key","readStream","catcher","concatStream","data","set","del","pipe","cacheThrough","pendingWriteStreams","length","writeStream","pop","objectMode","getBody","forEach","chunk","write","needsStream","get","Array","isArray","end","push","has","reset","module","exports"],"sources":["E:/MERN/AI image Generation App/ai_image_generation_app/client/node_modules/stream-catcher/index.js"],"sourcesContent":["var cache = require('lru-cache'),\n    through = require('through'),\n    concat = require('concat-stream');\n\nfunction StreamCatcher(options){\n    this._pendingWriteStreams = {};\n    this._reading = {};\n    this._cache = cache(options);\n}\nStreamCatcher.prototype.read = function(key, readStream){\n    var catcher = this,\n        concatStream = concat(function(data){\n            catcher._reading[key]--;\n            if(catcher._reading[key] === 0){\n                catcher._cache.set(key, data);\n            }\n        });\n\n    this._cache.del(key);\n\n    if(!this._reading[key]){\n        this._reading[key] = 0;\n    }\n\n    this._reading[key]++;\n\n    readStream.pipe(concatStream);\n\n    var cacheThrough = through(function(){\n        var pendingWriteStreams = catcher._pendingWriteStreams[key];\n\n        while(pendingWriteStreams && pendingWriteStreams.length){\n            var writeStream = pendingWriteStreams.pop();\n            if(readStream.objectMode){\n                concatStream.getBody().forEach(function(chunk){\n                    writeStream.write(chunk);\n                });\n            }else{\n                writeStream.write(concatStream.getBody());\n            }\n\n            readStream.pipe(writeStream);\n        }\n    });\n\n    readStream.pipe(cacheThrough);\n};\nStreamCatcher.prototype.write = function(key, writeStream, needsStream){\n    var data = this._cache.get(key);\n\n    if(data != null){\n        if(Array.isArray(data)){\n            data = '';\n        }\n        writeStream.write(data);\n        writeStream.end();\n        return;\n    }\n\n    if(!this._reading[key]){\n        if(needsStream){\n            needsStream(key);\n        }\n    }\n\n    if(!this._pendingWriteStreams[key]){\n        this._pendingWriteStreams[key] = [];\n    }\n\n    this._pendingWriteStreams[key].push(writeStream);\n};\nStreamCatcher.prototype.has = function(key){\n    return this._cache.has(key) || !!this._reading[key];\n};\nStreamCatcher.prototype.del = function(key){\n    return this._cache.del(key);\n};\nStreamCatcher.prototype.reset = function(key){\n    return this._cache.reset(key);\n};\n\nmodule.exports = StreamCatcher;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}